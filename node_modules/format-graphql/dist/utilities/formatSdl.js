"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _mapObj = _interopRequireDefault(require("map-obj"));

var _graphql = require("graphql");

var _optionalize = require("./optionalize");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const sortSchema = (key, value, options) => {
  const {
    sortArguments,
    sortDefinitions,
    sortFields
  } = options;

  if (sortDefinitions && key === 'definitions' || sortFields && key === 'fields' || sortArguments && key === 'arguments') {
    return [key, value.slice().sort((a, b) => {
      if (a.kind === 'SchemaDefinition') {
        return -1;
      }

      if (b.kind === 'SchemaDefinition') {
        return 1;
      }

      return a.name.value.localeCompare(b.name.value);
    })];
  }

  return [key, value];
};

const formatSdl = (schemaSdl, options) => {
  return (0, _graphql.print)((0, _mapObj.default)((0, _graphql.parse)(schemaSdl), (key, value) => {
    if (['definitions', 'fields', 'arguments'].includes(key) && Array.isArray(value)) {
      return sortSchema(key, value, (0, _optionalize.getOptions)(options));
    }

    return [key, value];
  }, {
    deep: true
  }));
};

var _default = formatSdl;
exports.default = _default;
//# sourceMappingURL=formatSdl.js.map